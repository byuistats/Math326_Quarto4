<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.344">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Math326 Notebook - ANOVA and the F-Test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Math326 Notebook</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-basics-of-design" role="button" data-bs-toggle="dropdown" aria-expanded="false">Basics of Design</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-basics-of-design">    
        <li>
    <a class="dropdown-item" href="./RCommands.html">
 <span class="dropdown-text">Key Principles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./RMarkdownHints.html">
 <span class="dropdown-text">Choosing a response variable</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./RCheatSheetsAndNotes.html">
 <span class="dropdown-text">Choosing conditions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DataSources.html">
 <span class="dropdown-text">Choosing units/experimental material</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-specific-designs" role="button" data-bs-toggle="dropdown" aria-expanded="false">Specific Designs</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-specific-designs">    
        <li>
    <a class="dropdown-item" href="./BasicFactorial_quarto.html">
 <span class="dropdown-text">Basic Factorial Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./BasicFactorial_quarto.html">
 <span class="dropdown-text">BF[1]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./BasicFactorial_quarto.html">
 <span class="dropdown-text">BF[2]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./BasicFactorial_quarto.html">
 <span class="dropdown-text">BF[3+]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Block.html">
 <span class="dropdown-text">Block Designs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Covariate.html">
 <span class="dropdown-text">Covariate Designs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./NestedFactor.html">
 <span class="dropdown-text">Nested Factor (aka Split Plot/Repeated Measure) Designs</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-broad-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false">Broad Topics</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-broad-topics">    
        <li>
    <a class="dropdown-item" href="./factor_structure.html">
 <span class="dropdown-text">Factor Structure</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./effects_model.html">
 <span class="dropdown-text">Effects Model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Anova_F-test.html">
 <span class="dropdown-text">ANOVA and the F-test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assumptions.html">
 <span class="dropdown-text">Assumptions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./contrast.html">
 <span class="dropdown-text">Contrasts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./MakingInference.html">
 <span class="dropdown-text">ZMultiple Pairwise Testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./WilcoxonTests.html">
 <span class="dropdown-text">ZUnbalanced Datasets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Kruskal.html">
 <span class="dropdown-text">ZPower??</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./LogisticRegression.html">
 <span class="dropdown-text">ZRandom Factors??</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-instructions" role="button" data-bs-toggle="dropdown" aria-expanded="false">R Instructions</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-instructions">    
        <li>
    <a class="dropdown-item" href="./DescribeData.html">
 <span class="dropdown-text">Descriptive Summaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./model_diagnostics.html">
 <span class="dropdown-text">Model diagnostics</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#anova-vs.-other-analysis-tools" id="toc-anova-vs.-other-analysis-tools" class="nav-link active" data-scroll-target="#anova-vs.-other-analysis-tools">ANOVA vs.&nbsp;Other Analysis Tools</a>
  <ul class="collapse">
  <li><a href="#multiple-t-tests" id="toc-multiple-t-tests" class="nav-link" data-scroll-target="#multiple-t-tests">Multiple t-tests</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">Regression</a></li>
  </ul></li>
  <li><a href="#what-is-analysis-of-variance" id="toc-what-is-analysis-of-variance" class="nav-link" data-scroll-target="#what-is-analysis-of-variance">What is Analysis of Variance</a></li>
  <li><a href="#anova-f-test-a-variance-ratio" id="toc-anova-f-test-a-variance-ratio" class="nav-link" data-scroll-target="#anova-f-test-a-variance-ratio">ANOVA F-test: A Variance Ratio</a>
  <ul class="collapse">
  <li><a href="#mean-squares-ms" id="toc-mean-squares-ms" class="nav-link" data-scroll-target="#mean-squares-ms">Mean Squares (MS)</a></li>
  <li><a href="#sum-of-squares-ss" id="toc-sum-of-squares-ss" class="nav-link" data-scroll-target="#sum-of-squares-ss">Sum of Squares (SS)</a></li>
  <li><a href="#degrees-of-freedom" id="toc-degrees-of-freedom" class="nav-link" data-scroll-target="#degrees-of-freedom">Degrees of Freedom</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ANOVA and the F-Test</h1>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>With the effects model defined we will want to test whether the treatment factor(s) has a statistically significant effect on the response variable. In other words we are interested in testing the hypotheses:</p>
<p><span class="math display">\[
H_0: \alpha_1 = \alpha_2 = ... = 0
\]</span> <span id="eq-hypotheses"><span class="math display">\[
H_a: \alpha_i \ne 0 \text{ for at least one i}
\qquad(1)\]</span></span></p>
<p>Where <span class="math inline">\(\alpha_i\)</span> represents the effect of a factor level.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Testing whether the effects are all equal to each other is incomplete, you must include the zero. Since all the factor level effects must sum to zero for a given factor, the only way all effects can be equal is if they are all zero.</p>
</div></div><p><strong>An</strong>alysis <strong>o</strong>f <strong>va</strong>riance (ANOVA) is a statistical technique that allows us to simultaneously test all factor level effects at the same time.</p>
<section id="anova-vs.-other-analysis-tools" class="level1">
<h1>ANOVA vs.&nbsp;Other Analysis Tools</h1>
<section id="multiple-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="multiple-t-tests">Multiple t-tests</h2>
<p>At this point it is reasonable to ask if we couldn’t arrive at the same conclusion by simply conducting multiple t-tests. For example, you could do a t-test for each factor level to determine if the effect is significantly different from zero. Or you might consider testing each combination of factor level effects to see if they are equal.</p>
<p>The multiple t-test approach has a couple of a drawbacks. The first drawback becomes apparent if you have many factor levels. If you only have 3 or 4 factor levels conducting many tests may be only a minor annoyance. However, if there are many factor levels it becomes a real burden to run, present and interpret so many tests.</p>
<p>The other main drawback of using multiple t-tests is more substantive and has to do with the probability of a Type I error. Suppose the treatment factor in our study has 3 levels. The null hypothesis associated with an ANOVA that tests all factor level effects simultaneously is:</p>
<p><span class="math display">\[
H_0: \alpha_1 = \alpha_2 =  \alpha_3 = 0
\]</span></p>
<p>Testing at a 0.05 significance level means there is a 0.05 probability we will incorrectly reject this null hypothesis (i.e.&nbsp;commit a Type I error). Conversely, there is 0.95 probability we will NOT commit a Type I error.</p>
<p>If we attempt to approach the problem by conducting multiple t-tests, we would test the following set of null hypotheses:</p>
<p><span class="math inline">\(H_0: \alpha_1 = 0\)</span> and <span class="math inline">\(H_0: \alpha_2 = 0\)</span> and <span class="math inline">\(H_0: \alpha_3 = 0\)</span>.</p>
<p>We may conduct each of these tests at the 0.05 significance level. Incorrectly rejecting the null hypothesis on any one of these tests would result in the same Type 1 error as incorrectly rejecting the null hypothesis of our ANOVA test of all the effects simultaneously.</p>
<p>So what is the probability of committing a Type 1 error in at least 1 of these 3 independent tests? The simplest way to find the probability of committing a Type 1 error in at least one of 3 tests is to calculate <span class="math inline">\(1 – P(\text{no Type 1 errors in all three tests})\)</span>. As previously stated, the significance level (0.05) of each test represents the probability of a Type 1 error. Therefore, the probability of <em>not</em> committing a Type 1 error on each test is 0.95. If we treat the tests as independent, we can find the probability of NOT committing a Type 1 error in all of the tests by multiplying the probabilities:</p>
<p><span class="math display">\[
0.95 * 0.95 * 0.95 = 0.857
\]</span></p>
<p>We can subsequently find <span class="math inline">\(1-0.857 = .143\)</span> is the probability of committing a Type 1 error in at least one of the tests, assuming all the null hypotheses are true. This is often referred to as the family wise error rate. The Type 1 error probability (0.143) in this family of t-tests is almost 3 times higher than the ANOVA Type 1 probability of 0.05.</p>
<p>In summary, ANOVA allows us to keep the number of tests manageable and it greatly simplifies how Type 1 error is addressed. If we consider a study with more than 1 factor, the advantages of ANOVA increase. ANOVA is a more powerful test because, unlike a multiple t-test approach, while testing one factor’s effects it can account for the other factors’ impact on the response. In this regard, ANOVA is similar to regression.</p>
</section>
<section id="regression" class="level2">
<h2 class="anchored" data-anchor-id="regression">Regression</h2>
<p>Indeed, ANOVA and linear regression are more similar than they are different. ANOVA and linear regression tend to each have their own vocabulary because they were developed under different circumstances. ANOVA was developed to deal with agricultural experiments where the independent variables were primarily categorical. Linear regression tends to be introduced as a tool to analyze data where the independent variables are quantitative. Though the language and output associated with each technique may appear different on the surface, the “math” (i.e.&nbsp;the linear algebra) underlying the hood of the techniques is identical. It is not uncommon to have a study where there are multiple quantitative independent variables and multiple categorical independent variables. Thus, the differences between the two lie more in the problems they tend to be applied to and the vocabulary of the researcher than in any meaningful difference in results.</p>
</section>
</section>
<section id="what-is-analysis-of-variance" class="level1">
<h1>What is Analysis of Variance</h1>
<p>Though ANOVA may seem intimidating at first, the underlying idea is relatively simple. If we want to determine if a factor has a significant effect on a response variable we can look at the variance, or spread, in the resulting data. Specifically, we will compare the spread between factor level means with the spread of observations within a factor level.</p>
<p><a href="#fig-xo-different">Figure&nbsp;1</a> illustrates some made up data for a very simple, generic example where there are just two factor levels: X and O.</p>
<div id="fig-xo-different" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/x-o_sig.JPG" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Factor level means are different</figcaption><p></p>
</figure>
</div>
<p>Each individual observation is represented by a black X or O above the number line. The factor level mean for each factor is in blue, plotted beneath the number line. It is apparent that the X factor level and the O factor level are different. The spread between factor level means is quite large relative to the spread of observations within each factor level.</p>
<p>Now consider the case, in <a href="#fig-xo-same">Figure&nbsp;2</a>, where the spread between factor level means is quite small relative to the spread of observations within a factor level. This suggests that the difference in factor level means could just as easily be due to random chance as due to a real difference between factor levels.</p>
<div id="fig-xo-same" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/xo-same.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Factor level means are close</figcaption><p></p>
</figure>
</div>
<p>The same logic that helped us arrive at conclusions in <a href="#fig-xo-different">Figure&nbsp;1</a> and <a href="#fig-xo-same">Figure&nbsp;2</a> are used in ANOVA. The main difference is that we use a variance calculation instead of a visual assessment of spread. We will also employ formal hypothesis testing techniques.</p>
</section>
<section id="anova-f-test-a-variance-ratio" class="level1 page-columns page-full">
<h1>ANOVA F-test: A Variance Ratio</h1>
<p>To test the hypotheses in <a href="#eq-hypotheses">Equation&nbsp;1</a> we will compare the variation in factor level means to the variation of observations within a factor level. This ratio of variances follows an F distribution<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, and is therefore called an <strong>F test statistic</strong>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
F statistic and p-value
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
F = \frac{\text{Variation between factor levels}}{\text{Variation within factor levels}}
\]</span></p>
</div>
</div>
<p>The F distribution is defined by 2 values for degrees of freedom. A degrees of freedom value for the between factor levels variance estimate in the numerator, and a degrees of freedom value for the within factor level variance estimate in the denominator. The p-value for the ANOVA F-test is calculated as the area under the F distribution curve to the right of the F statistic, as shown in <a href="#fig-pvalue">Figure&nbsp;3</a> .</p>
<div id="fig-pvalue" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/p-value_example.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3: Example P-value calculation based on a F-statistic of 2.23 and an F distribution with 3 and 16 degrees of freedom</figcaption><p></p>
</figure>
</div>
<p>If the ratio of variances is large (as in <a href="#fig-xo-different">Figure&nbsp;1</a>), then we get a large F statistic and a small p-value. If the p-value is less than our chosen level of significance we conclude that at least one factor level effect is non-zero. As the F ratio gets smaller and approaches 1 (similar to <a href="#fig-xo-same">Figure&nbsp;2</a>) our p-value increases and we may have insufficient evidence to say that the treatment factor has an effect on the response.</p>
<p>An F-test is only performed on structural factors. A test of the benchmark is not interesting, and a test of the residual error factor does not make sense.</p>
<p>The question then follows, <strong>how do we estimate variation between factor levels and within factor levels?</strong></p>
<p>Similar to the way in which we were able to break down each observation into its component parts using the <a href="./effects_model.html">effects model</a>, we now want to break down the variability in the dataset into its component parts. We will estimate how much of the total variability in the dataset comes from each of the terms (or factors) in the effects model.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The effects model:</p>
<p><span class="math inline">\(y_\text{ij} = \mu + \alpha_i + \epsilon_\text{ij}\)</span></p>
</div></div><p>The breakdown of variability and the resulting F-statistic and p-value are often displayed in an ANOVA summary table. <a href="#tbl-blank-table">Table&nbsp;2</a> is a blank version of the ANOVA summary table with just 1 structural factor/treatment. This table is essentially a container to provide perspective about how variability in the dataset is allocated across factors. On the far left, we list out the factors in our study as sources of variability. On the far right, we display the F-statistic and p-value which have already been discussed. So we still need to explain the df, SS, and MS columns.</p>
<div id="tbl-blank-table" class="anchored">
<table class="table">
<caption>Table 1: Blank ANOVA summary table for an experiment with 1 treatment factor</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">SS</th>
<th style="text-align: center;">MS</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Benchmark</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Factor</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual Error</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<section id="mean-squares-ms" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="mean-squares-ms">Mean Squares (MS)</h2>
<p>You can think of Mean Squares (MS) as synonymous with variance. The F statistic is a ratio of variances:</p>
<p><span class="math display">\[
F = \frac{\text{Variation between factor levels}}{\text{Variation within factor levels}} = \frac{\text{Mean squares of treatment factor means}}{\text{Mean squares of residual errors}}
\]</span></p>
<p>With this is mind, we can fill in the F column of the ANOVA table for Treatment Factor.</p>
<div id="tbl-blank-table" class="anchored">
<table class="table">
<caption>Table 2: Blank ANOVA summary table for an experiment with 1 treatment factor</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">SS</th>
<th style="text-align: center;">MS</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Benchmark</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Factor</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MS_\text{Treatment Factor}}{MS_\text{Residual Error}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual Error</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<p>To find the variation between factor level means, calculate the sample variance of factor level means and multiply it by the number of replicates in each factor level. (In the case of unbalanced data where you do not have the same number of replicates in each factor level, weighting by sample size is needed).</p>
<p>The Mean Squares of the residual error factor (i.e.&nbsp;Mean Squared Error, MSE) represents the within factor level variation. To calculate it you can find the sample variance within each factor level and then take the mean of those variances. (In the case of unbalanced data where you do not have the same number of replicates in each factor level, you would take a weighted average).</p>
<div id="fig-between-within" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/between-within.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4: Data from an experiment with 3 factor levels is shown in two separate panels. Left panel shows variation between factor level means. Right panel shows variation within factor levels.</figcaption><p></p>
</figure>
</div>
<p>In <a href="#fig-between-within">Figure&nbsp;4</a> data from an experiment with 3 factor levels is shown. The panel on the left shows the factor level means plotted as points and the grand mean as a read line. In the panel on the right, the factor level means are plotted in blue and the deviation from each point to its respective factor level mean is depicted. From the panel on the left we can see the between group variation. As mentioned above, the mean squares for treatment could be computed as the variance of the 3 factor level means, and multiplied by 15 (the number of replicates in each factor level). The mean square error could be computed by finding the sample variance within each group and then taking the mean of those 3 variance estimates.</p>
<p>Though the above methods work, the ANOVA summary table captures interim steps for an alternative (preferred) algorithm for calculating mean squares. Since <strong>Mean Squares is synonymous with variance</strong>, now is a good time to review the sample variance formula.</p>
<p><span id="eq-sample-variance"><span class="math display">\[
s^2 = \frac{\sum{(y_i - \bar{y})}^2}{n-1}
\qquad(2)\]</span></span></p>
<p>Upon closer examination of <a href="#eq-sample-variance">Equation&nbsp;2</a> you can see that this formula is essentially a mean. In fact, you can think of variance as a mean of squared deviations (a.k.a. errors). Any mean is built using 2 parts:</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Recall that an effect is defined as a deviation from the mean.</p>
</div></div><ul>
<li>numerator: a sum or total</li>
<li>denominator: the number of pieces of information used to create the sum in the numerator</li>
</ul>
<p>Here, the numerator is the sum of squares and the denominator is the degrees of freedom.</p>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">SS</th>
<th style="text-align: center;">MS</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Benchmark</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Factor</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\frac{SS_\text{Treatment Factor}}{df_\text{Treatment Factor}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MS_\text{Treatment Factor}}{MS_\text{Residual Error}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual Error</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\frac{SS_\text{Residual Error}}{df_\text{Residual Error}}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="sum-of-squares-ss" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sum-of-squares-ss">Sum of Squares (SS)</h2>
<p>Let’s talk about the numerator first, this will be the sum of squared deviations, or <strong>Sum of Squares</strong> for short. The Sum of Squares is a measure of the total variability in a dataset. A naïve approach to calculating total variability in a dataset is to measure the distance from each value to the mean of the dataset. The problem with this approach is that those distance measures will always sum to zero.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Don’t believe me? Go ahead and test it out. Pick some numbers and find their mean. Then calculate each number’s distance from the mean (keeping track of negative versus positive distances) and add them up. You will always end up with a sum of zero.</p>
</div></div><p>To avoid this problem, statisticians square the distances before summing them. This results in a value that summarizes the total amount of spread in the dataset. This quantity, the Sum of Squares, is important and so it has its own column in the ANOVA summary table.</p>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">SS</th>
<th style="text-align: center;">MS</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Benchmark</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(n*\bar{y}_\text{..}^2\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Factor</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math display">\[ \sum \hat{\alpha}_i^2*n_i\]</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{SS_\text{Treatment Factor}}{df_\text{Treatment Factor}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MS_\text{Treatment Factor}}{MS_\text{Residual Error}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual Error</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math display">\[ \sum \hat{\epsilon}_\text{ij}^2 \]</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{SS_\text{Residual Error}}{df_\text{Residual Error}}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(y_\text{ij}^2\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="degrees-of-freedom" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of Freedom</h2>
<p>In short, you can think of degrees of freedom as the number of unique pieces of information that contributed to the variance estimate.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Degrees of Freedom
</div>
</div>
<div id="tip-degrees-of-freedom" class="callout-body-container callout-body">
<p><strong>The number of unique pieces of information that contributed to the variance estimate.</strong></p>
</div>
</div>
<p>In our dataset we have a certain number of observations. All those observations can be used to estimate the variance in the dataset. But you will notice in <a href="#eq-sample-variance">Equation&nbsp;2</a> the data has already been used to estimate the grand mean (<span class="math inline">\(\bar{y}\)</span> estimates <span class="math inline">\(\mu\)</span>). In other words, before we can estimate the variance we must use the data to estimate the mean. Estimating the mean “uses up” one degree of freedom. This is why the denominator of the sample variance formula divides by <span class="math inline">\(n-1\)</span> instead of by <span class="math inline">\(n\)</span>.</p>
<p>For additional explanation, consider this simple example. I have three data points and I know that the mean of these 3 data points is 10. The value of the first data point could be any number, it is free to vary. The value of the second data point could be any number also, it is free to vary. The third number’s value is not free to vary. It is constrained by the fact that the mean of the 3 data points must be 10. The values of the first two datapoints will determine the value of the third under the constraint of a known (or estimated) mean.</p>
<div id="tbl-df-example" class="anchored">
<table class="table">
<caption>Table 3: Only n-1 values are free to vary when the mean of the values is known</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">value 1</th>
<th style="text-align: center;">value 2</th>
<th style="text-align: center;">value 3</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">Mean of 3 Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">a</td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"><span class="math inline">\(3*10 - (a+b)\)</span></td>
<td style="text-align: center;">-&gt;</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">free to vary</td>
<td style="text-align: center;">free to vary</td>
<td style="text-align: center;">depends on other two values</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<p>How does this apply to the analysis of variance? Well, initially I have <span class="math inline">\(n\)</span> observations, or in other words <span class="math inline">\(n\)</span> unique pieces of information that can be used to estimate variance of the dataset. As I try to break the variance into its component pieces, I will also need to reallocate those <span class="math inline">\(n\)</span> pieces of information to each factor (benchmark, treatment factor, residual error) for use in estimating their mean squared error. To paraphrase the law of the conservation of mass, “the amount of information can neither be created nor destroyed”.</p>
<p>We will reason through the degrees of freedom calculation for each of the 3 sources in the ANOVA table. Keep in mind, we are using the simplest experiment, just one treatment factor, to illustrate these concepts. In more complex designs, there will be additional factors listed in the “sources” column.</p>
<p>As was mentioned, every time we use the data to estimate a parameter we use a degree of freedom. To find the benchmark effect we take all the values and estimate the grand mean; that uses up one degree of freedom because we have estimated 1 mean.</p>
<p>When calculating the degrees of freedom for the treatment factor you might be tempted to think that the degrees of freedom is equal to the number of factor levels because you have to estimate a mean for each level. But, remember the simple example depicted in figure <a href="#tbl-df-example">Table&nbsp;3</a>. Because I have already estimated the grand mean (benchmark), the last factor level is is not free to vary and so is not estimated directly. The mean of the last factor level will have to be a number that satisfies the constraint that the mean of all the factor level means is the grand mean.</p>
<p>Explained another way, consider the fact that all the factor level effects must sum to zero. If there are <span class="math inline">\(m\)</span> factor levels, I only need to estimate effects for <span class="math inline">\(m-1\)</span> levels. The last level’s effect is a function of the other factor level effects, it does not need to be estimated and therefore does not need a degree of freedom.</p>
<p>Finally, consider the <strong>residual error factor</strong>. The non-technical definition of the term residual means “left over”. The degrees of freedom for the residual error factor is whatever degrees of freedom are left over.</p>
<p>In summary, to estimate the degrees of freedom for a factor, I start with the total number of observations and then subtract the number of means that need to be calculated in order to calculate the factor’s level effects. This is exactly what the general rule for finding degrees of freedom tells us.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
General rule to find degrees of freedom for a factor
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\text{df} = \text{number of levels} - \text{sum of df of outside factors}
\]</span></p>
</div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>F is a random variable. This means we never know exactly what the value of F will be based on random selection/assignments. However, we do know that under the null hypothesis some values of F are more likely than others. Specifically, if the null hypothesis were true then values of 1 are more likely and large values tend to be less likely. The F distribution represents probability distribution distribution of the variance ratios. In a given study just one random sample is taken and one variance F ratio is calculated. However, a different selection of experimental units (or different assignment to factor levels) would result in different estimates of variances, and consequently different F statistics. The F distribution represents all possible F statistics under the null hypothesis that a factor has no significant effect.</p>
<p>When a treatment factor has no significant effect on the response variable, the expected F statistic is 1. This is because there are two sources of variability contributing to our estimate of the treatment factor variance (numerator): variance in factor level means and variance within a factor level. In the denominator of the F statistic is simply the variance within a factor level. So the F statistics looks like this:</p>
<p><span class="math display">\[
F = \frac{\text{variance in factor level means} + \text{variance within factor levels}}{\text{variance within factor levels}}
\]</span></p>
<p>If there really is no significant effect across factor levels, then the variance in factor level means goes to zero and we are left with:</p>
<p><span class="math display">\[
F = \frac{\text{variance within factor levels}}{\text{variance within factor levels}} = 1
\]</span></p>
<p>The values for degrees of freedom affect the shape and the spread of the F distribution. Visit <a href="https://keisan.casio.com/exec/system/1180573185">this applet</a> to learn more and interact with the family of F distributions.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>