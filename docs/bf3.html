<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Math326 Notebook - BF[3]</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Math326 Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-basics-of-design" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Basics of Design</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-basics-of-design">    
        <li>
    <a class="dropdown-item" href="./key_principles.html" rel="" target="">
 <span class="dropdown-text">Key Principles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./research_objectives.html" rel="" target="">
 <span class="dropdown-text">Research Objectives</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./response_variable.html" rel="" target="">
 <span class="dropdown-text">Response Variable</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./experimental_units.html" rel="" target="">
 <span class="dropdown-text">Experimental Units</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sources_of_variances.html" rel="" target="">
 <span class="dropdown-text">Sources of Variation - Factors and Conditions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./randomization.html" rel="" target="">
 <span class="dropdown-text">Randomization</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-specific-designs" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Specific Designs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-specific-designs">    
        <li>
    <a class="dropdown-item" href="./BasicFactorial_intro.html" rel="" target="">
 <span class="dropdown-text">Basic Factorial Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./BasicFactorial_quarto_boat.html" rel="" target="">
 <span class="dropdown-text">BF[1]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./bf2.html" rel="" target="">
 <span class="dropdown-text">BF[2]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./bf3.html" rel="" target="">
 <span class="dropdown-text">BF[3+]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./block_intro.html" rel="" target="">
 <span class="dropdown-text">Blocking Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./cb1.html" rel="" target="">
 <span class="dropdown-text">CB[1]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ancova.html" rel="" target="">
 <span class="dropdown-text">ANCOVA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./latin_square.html" rel="" target="">
 <span class="dropdown-text">Latin Square</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./NestedFactor.html" rel="" target="">
 <span class="dropdown-text">Nested Factor (aka Split Plot/Repeated Measure) Designs</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-broad-topics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Broad Topics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-broad-topics">    
        <li>
    <a class="dropdown-item" href="./factor_structure.html" rel="" target="">
 <span class="dropdown-text">Factor Structure</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./effects_model.html" rel="" target="">
 <span class="dropdown-text">Effects Model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Anova_F-test.html" rel="" target="">
 <span class="dropdown-text">ANOVA and the F-test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assumptions.html" rel="" target="">
 <span class="dropdown-text">Assumptions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./contrast.html" rel="" target="">
 <span class="dropdown-text">Contrasts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multiple_comparisons.html" rel="" target="">
 <span class="dropdown-text">Multiple Comparisons</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./unbalanced.html" rel="" target="">
 <span class="dropdown-text">Unbalanced Datasets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Kruskal.html" rel="" target="">
 <span class="dropdown-text">ZPower??</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./LogisticRegression.html" rel="" target="">
 <span class="dropdown-text">ZRandom Factors??</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-instructions" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R Instructions</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-instructions">    
        <li>
    <a class="dropdown-item" href="./DescribeData.html" rel="" target="">
 <span class="dropdown-text">Descriptive Summaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./diagnostics.html" rel="" target="">
 <span class="dropdown-text">Model diagnostics</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-datasets">    
        <li>
    <a class="dropdown-item" href="././Data/AnalysisRubric.html" rel="" target="">
 <span class="dropdown-text">XYZ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="././Data/StudentHousing.html" rel="" target="">
 <span class="dropdown-text">yadda yadda</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul>
  <li><a href="#factor-structure" id="toc-factor-structure" class="nav-link" data-scroll-target="#factor-structure">Factor Structure</a></li>
  <li><a href="#hypothesis-and-model" id="toc-hypothesis-and-model" class="nav-link" data-scroll-target="#hypothesis-and-model">Hypothesis and Model</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a></li>
  </ul></li>
  <li><a href="#design" id="toc-design" class="nav-link" data-scroll-target="#design">Design</a></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction">Interaction</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BF[3]</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
</script>
<section id="overview" class="level1 page-columns page-full">
<h1>Overview</h1>
<p>This section will extend a factorial design with two factors to a full factorial design with three factors. The design and analysis of a fully factorial experiment with three factors is very similar to the two factor design. The one notable exception is that now there is the potential for higher order interactions. Instead of just a single two-way interaction to be considered, three-way interactions, as well as all possible two-way interactions, are included in the model</p>
<p>To illustrate this design and analysis we will use a fictitious dataset that closely mirrors the <a href="https://www.scopus.com/record/display.uri?eid=2-s2.0-0017812077&amp;origin=inward&amp;txGid=d11bc22f7fa2dd7a30ab0c43490b98d3">real experiment conducted by Robert Kaplan</a>. The experiment’s goal was to show how the <a href="https://en.wikipedia.org/wiki/Halo_effect">halo effect</a> due to attractiveness effects influences an assessment. More precisely, how does an author’s attractiveness, their sex, and the sex of the reader impact the reader’s assessment of the author’s talent as a writer.</p>
<p>To carry out the experiment, a participant is treated as the reader. There were 48 readers total, 24 male and 24 female. The participant is asked to read an essay. Though all participants read the same essay, the sex of the author and the attractiveness of the author was varied. This was accomplished by attaching a picture of the author to the essay. There were 3 levels of attractiveness for each author sex: attractive, unattractive, and the control group (where no picture was attached). Each reader was randomly assigned to an author sex and attractiveness level such that for every combination of reader sex, author sex, and author attractiveness there were exactly 4 observations gathered, resulting in a total of 48 observations.</p>
<p>It is cleaner and easier to show the data in a different format than has been used up to this point. In <a href="#tbl-data">Table&nbsp;1</a>, each factor has a column dedicated to show what factor level the observations in that row belong to. There are 12 unique factor level combinations, and therefore 12 rows in the dataset. There are 4 observations per factor level combination, and they are displayed to the right of factor level combination designation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"attractive"</span>, <span class="st">"unattractive"</span>, <span class="st">"no-pic"</span>), <span class="dv">16</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>reader <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>), <span class="at">each =</span> <span class="dv">3</span>), <span class="dv">8</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>author <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>), <span class="at">each =</span> <span class="dv">6</span>), <span class="dv">4</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>round <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">12</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>the_means <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">70</span>, <span class="dv">70</span> , <span class="dv">70</span>, <span class="dv">90</span>, <span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">90</span>, <span class="dv">70</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>talent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, the_means, <span class="dv">5</span>),<span class="dv">0</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, the_means, <span class="dv">5</span>),<span class="dv">0</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, the_means, <span class="dv">5</span>),<span class="dv">0</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, the_means, <span class="dv">5</span>),<span class="dv">0</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(attractiveness) <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(author, reader, talent, round) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(attractiveness, author, reader)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">"reader"</span>, <span class="st">"author"</span>, <span class="st">"attractiveness"</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_from =</span> round,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_from =</span> talent) <span class="sc">%&gt;%</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(reader, author, attractiveness) <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(row) <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pander</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-data" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;1: Table of Means for Each Factor Level Combination</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">row</th>
<th style="text-align: center;">reader</th>
<th style="text-align: center;">author</th>
<th style="text-align: center;">attractiveness</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">49</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">50</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">no-pic</td>
<td style="text-align: center;">69</td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">74</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">94</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">94</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
<td style="text-align: center;">63</td>
<td style="text-align: center;">68</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">72</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">no-pic</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">67</td>
<td style="text-align: center;">62</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
<td style="text-align: center;">68</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">66</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
<td style="text-align: center;">76</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">89</td>
<td style="text-align: center;">93</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">no-pic</td>
<td style="text-align: center;">68</td>
<td style="text-align: center;">71</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">65</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">52</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">48</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
<td style="text-align: center;">86</td>
<td style="text-align: center;">77</td>
<td style="text-align: center;">79</td>
<td style="text-align: center;">75</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">no-pic</td>
<td style="text-align: center;">79</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">67</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">12</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
<td style="text-align: center;">57</td>
<td style="text-align: center;">67</td>
<td style="text-align: center;">53</td>
<td style="text-align: center;">66</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="factor-structure" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="factor-structure">Factor Structure</h2>
<p>We can still partition the observations, but with 3 factors the partitions become harder to show with just lines. Instead, the partitions will be described and a table of factor levels will be shown below.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>In the <a href="#appendix">appendix</a>, partitioning is done using shading/coloring of cells. Though it is possible, the result is a bit overwhelming to the eye.</p>
</div></div><p>In this experiment there are 3 controlled factors. Observations can be partitioned according to what group they belong to for any one of the 3 controlled factors. This allows us to create 3 structural factors, 1 for each controlled factor:</p>
<ul>
<li>reader’s sex: 2 levels.</li>
<li>author’s sex: 2 levels, and</li>
<li>attractiveness (of the essay author): 3 levels,</li>
</ul>
<p>The partition associated with each of these factors will allow us to calculate main effects.</p>
<p>The data can also be partitioned according to a shared factor level combination on a pair of factors. There are 3 possible factor pairs. In other words, three two-way interactions are created by partitioning the data this way:</p>
<ul>
<li>reader <span class="math inline">\(\times\)</span> author: 4 levels</li>
<li>reader <span class="math inline">\(\times\)</span> attractiveness: 6 levels</li>
<li>author <span class="math inline">\(\times\)</span> attractiveness: 6 levels</li>
</ul>
<p>Finally, data values can be partitioned according to what combination of the 3 treatment factors the observation belongs to. This results in a 3-way interaction factor:</p>
<ul>
<li>reader <span class="math inline">\(\times\)</span> author <span class="math inline">\(\times\)</span> attractiveness: 12 levels</li>
</ul>
<p>The table below summarizes the 7 structural factors in the model:</p>
<!-- Use ctrl + space to make a non-breaking white space that doesn't just get collapsed. It is represented with a light gray dot in Rstudio markdown before rendering. -->
<table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 11%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th>Factor</th>
<th style="text-align: center;"># of levels</th>
<th>Partitions: Row #’s of <a href="#tbl-data">Table&nbsp;1</a> belonging to each level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>reader</td>
<td style="text-align: center;">3</td>
<td><p>female: 1-6</p>
<p>male: &nbsp;&nbsp;&nbsp;7-12</p></td>
</tr>
<tr class="even">
<td>author</td>
<td style="text-align: center;">2</td>
<td><p>female: 1-3, 7-10</p>
<p>male: &nbsp;&nbsp;&nbsp;4-6, 11-12</p></td>
</tr>
<tr class="odd">
<td>attractiveness</td>
<td style="text-align: center;">2</td>
<td><p>attractive: &nbsp;&nbsp;&nbsp;1, 4, 7, 10</p>
<p>no-pic: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2, 5, 8, 11</p>
<p>unattractive: 3, 6, 9, 12</p></td>
</tr>
<tr class="even">
<td>reader <span class="math inline">\(\times\)</span> author</td>
<td style="text-align: center;">4</td>
<td><table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>female reader</th>
<th style="text-align: left;">male reader</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>female author: 1-3</p>
<p>male author: &nbsp;&nbsp;4-6</p></td>
<td style="text-align: left;"><p>female author: 7-9</p>
<p>male author: &nbsp;&nbsp;10-12</p></td>
</tr>
</tbody>
</table></td>
</tr>
<tr class="odd">
<td>reader <span class="math inline">\(\times\)</span> attractiveness</td>
<td style="text-align: center;">6</td>
<td><table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>female reader</th>
<th style="text-align: left;">male reader</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>attractive: 1, 4</p>
<p>no-pic: 2, 5</p>
<p>unattractive: 3, 6</p></td>
<td style="text-align: left;"><p>attractive: 7, 10</p>
<p>no-pic: 8, 11</p>
<p>unattractive: 9, 12</p></td>
</tr>
</tbody>
</table></td>
</tr>
<tr class="even">
<td>author <span class="math inline">\(\times\)</span> attractiveness</td>
<td style="text-align: center;">6</td>
<td><table class="table">
<colgroup>
<col style="width: 41%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>female author</th>
<th style="text-align: left;">male author</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>attractive: 1, 7</p>
<p>no-pic: 2, 8</p>
<p>unattractive: 3, 9</p></td>
<td style="text-align: left;"><p>attractive: 4, 10</p>
<p>no-pic: 5, 11</p>
<p>unattractive: 6, 12</p></td>
</tr>
</tbody>
</table></td>
</tr>
<tr class="odd">
<td>reader <span class="math inline">\(\times\)</span> author <span class="math inline">\(\times\)</span> attractiveness</td>
<td style="text-align: center;">12</td>
<td><p>female, female, attractive: 1</p>
<p>female, female, no-pic: 2</p>
<p>female, female, unattractive: 3</p>
<p>female, male, attractive: 4</p>
<p>female, male, no-pic: 5</p>
<p>female, male, unattractive: 6</p>
<p>male, female, attractive: 7</p>
<p>male, female, no-pic: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8</p>
<p>male, female, unattractive: 9</p>
<p>male, male, attractive: 10</p>
<p>male, male, no-pic: 11</p>
<p>male, male, unattractive: 12</p></td>
</tr>
</tbody>
</table>
</section>
<section id="hypothesis-and-model" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-and-model">Hypothesis and Model</h2>
<p>Each factor (i.e.&nbsp;meaningful partition of the data) corresponds to a term in <a href="#eq-bf3">Equation&nbsp;1</a>:</p>
<p><span id="eq-bf3"><span class="math display">\[
y_\text{ijkl} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_\text{ij} + (\alpha\gamma)_\text{ik} + (\beta\gamma)_\text{jk} + (\alpha\beta\gamma)_\text{ijk} + \epsilon_\text{ijkl}
\tag{1}\]</span></span></p>
<p>Where</p>
<ul>
<li><span class="math inline">\(y_{ijkl}\)</span> is the <span class="math inline">\(l^{th}\)</span> observation from the factor level combination of <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span>, and <span class="math inline">\(\gamma_k\)</span>.</li>
<li><span class="math inline">\(\mu\)</span> is the grand mean of all the observations.</li>
<li><span class="math inline">\(\alpha\)</span> is the effect of reader’s gender, and <span class="math inline">\(i\)</span> has 2 levels</li>
<li><span class="math inline">\(\beta\)</span> is the effect of author’s gender, and <span class="math inline">\(j\)</span> has 2 levels</li>
<li><span class="math inline">\(\gamma\)</span> is the effect of author’s attractiveness, and <span class="math inline">\(k\)</span> has 3 levels: attractive, neural, and unattractive</li>
<li>The <span class="math inline">\((\alpha\beta)_\text{ij}\)</span> is the interaction effect for reader gender with author gender on perceived talent level.</li>
<li>The <span class="math inline">\((\alpha\gamma)_\text{ik}\)</span> is the interaction effect for reader gender with author attractiveness on perceived talent.</li>
<li>The <span class="math inline">\((\beta\gamma)_\text{jk}\)</span> is the interaction effect for author gender with attractiveness on perceived talent.</li>
<li>The <span class="math inline">\((\alpha\beta\gamma)_\text{ijk}\)</span> is the interaction effect for reader gender, author gender, and attractiveness on perceived talent.</li>
<li><span class="math inline">\(\epsilon\)</span> is the residual error term, and <span class="math inline">\(l\)</span> is the replicate count within a factor level combination.</li>
</ul>
<p>Though we have seen two factor interactions and know how to deal with them, the three factor interaction is something new. Including this term in the model means that the impact of any of the three variables depends on the levels of the other two. Stated another way, the nature of the two-way interaction depends on the level of the third variable.</p>
<p>The main effects and two-way interactions are tested just as they were in the <a href="./bf2.html">BF[2]</a> model. The hypothesis for the 3-way interaction is</p>
<p><span class="math display">\[
H_0: (\alpha\beta\gamma)_\text{ijk} = 0 \text{ for all } ijk
\]</span></p>
<p><span class="math display">\[
H_a: (\alpha\beta\gamma)_\text{ijk} \ne 0 \text{ for some } ijk
\]</span></p>
</section>
<section id="assumptions" class="level2">
<h2 class="anchored" data-anchor-id="assumptions">Assumptions</h2>
<p>A three-way ANOVA model may be used to analyze data from a BF[3] design if the following requirements are satisfied. Note that these requirements are identical to the requirements of a BF[2] two-way ANOVA.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 36%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Requirements</th>
<th>Method for Checking</th>
<th>What You Hope to See</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Constant variance across factor levels</td>
<td>Residual vs.&nbsp;Fitted Plot</td>
<td>No major disparity in vertical spread of point groupings</td>
</tr>
<tr class="even">
<td></td>
<td>Levene’s Test</td>
<td>Fail to reject <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="odd">
<td>Normally Distributed Residuals</td>
<td>Normal Q-Q plot</td>
<td>Straight line, majority of points in boundaries</td>
</tr>
<tr class="even">
<td>Independent residuals</td>
<td>Order plot</td>
<td>No pattern/trend</td>
</tr>
<tr class="odd">
<td></td>
<td>Familiarity with/critical thinking about the experiment</td>
<td>No potential source for bias</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="design" class="level1">
<h1>Design</h1>
<p>In a basic factorial design of 3 factors, three factors are purposely varied in such a way that observations are obtained for every possible factor level combination. Each factor level combination is considered a treatment.</p>
<p>In a completely randomized design, each experimental unit is randomly assigned to exactly 1 factor level combination. It can be helpful to first list out all the subjects and factor level combinations in a table. This can be done by listing all the subjects, then listing the values of each factor in a separate column.</p>
<p>There are $ $ factor level combinations. If we want to observe each factor level combination 4 times, we need <span class="math inline">\(12 \times 4 = 48\)</span> observations.</p>
<p><a href="javascript:showhide('unrandomized')"><span style="font-size:8pt;">click twice to show/hide data</span></a></p>
<div id="unrandomized">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a sequence from 1 to 48</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Paste the word "Subject " in front of each id #</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Subject <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Subject"</span>, <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>), <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a vector with each reader gender repeated 24 times</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>reader <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>), <span class="at">each =</span> <span class="dv">24</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a vector with each author gender repeated 24 times</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>author <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>), <span class="at">each =</span> <span class="dv">12</span>, <span class="at">times =</span> <span class="dv">2</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a vector with each level of attractiveness repeated 16</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"attractive"</span>, <span class="st">"neutral"</span>, <span class="st">"unattractive"</span>), <span class="at">times =</span> <span class="dv">16</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Combine the vectors of Subject ID's and controlled factor levels into one tibble/dataset</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>assignment_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Subject, reader, author, attractiveness)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#print the table, pander() makes it look nice</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(assignment_table) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Subject</th>
<th style="text-align: center;">reader</th>
<th style="text-align: center;">author</th>
<th style="text-align: center;">attractiveness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Subject 1</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 2</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 3</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 4</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 5</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 6</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 7</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 8</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 9</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 10</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 11</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 12</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 13</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 14</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 15</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 16</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 17</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 18</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 19</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 20</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 21</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 22</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 23</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 24</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 25</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 26</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 27</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 28</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 29</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 30</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 31</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 32</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 33</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 34</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 35</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 36</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 37</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 38</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 39</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 40</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 41</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 42</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 43</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 44</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 45</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 46</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 47</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 48</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now randomize which subjects get which treatment (aka - factor level combination).</p>
<p><a href="javascript:showhide('randomized')"><span style="font-size:8pt;">click twice to show/hide data</span></a></p>
<div id="randomized">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#randomize subject assignment to treatment</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>randomized_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">sample</span>(Subject), reader, author, attractiveness)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print the table, pander() makes it look nice</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(randomized_table) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">sample(Subject)</th>
<th style="text-align: center;">reader</th>
<th style="text-align: center;">author</th>
<th style="text-align: center;">attractiveness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Subject 28</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 25</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 33</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 24</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 19</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 40</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 20</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 21</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 37</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 29</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 35</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 18</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 8</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 1</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 48</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 13</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 32</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 31</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 7</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 23</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 42</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 38</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 17</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 6</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 26</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 36</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 3</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 11</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 30</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 43</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 34</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 10</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 5</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 4</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 45</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 41</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 46</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 12</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 27</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 47</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 15</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 22</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 44</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 39</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 14</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 16</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">attractive</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Subject 2</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">neutral</td>
</tr>
<tr class="even">
<td style="text-align: center;">Subject 9</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">unattractive</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="interaction" class="level1 page-columns page-full">
<h1>Interaction</h1>
<p>We can visually investigate main effects and two-way interactions in the same way that was explained on the <a href="./bf2.html">BF[2]</a> page. To visually inspect the possibility of a 3-way interaction, you can create two-way interaction charts faceted by the third variable.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>A chart to inspect a two-way interaction consists of plotting the mean of each factor level combination</p>
</div></div><p>It technically does not matter which of the three variables in the interaction you use for faceting, if a three way interaction is there it should be visible. However, it sometimes can be easier to spot the interaction or be more intuitive to interpret the interaction when faceting on one variable instead of another.</p>
<p>For the study on the halo effect of attractiveness example, we start by computing the mean perceived talent level of our observed data, contained in <a href="#tbl-data">Table&nbsp;1</a>. The means are shown in <a href="#tbl-means2">Table&nbsp;2</a> and the interaction plots created from those means are shown in <a href="#fig-ints2">Figure&nbsp;1</a>.</p>
<div id="tbl-means2" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;2: Means for Each Factor Level Combination</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-means2-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-means2" style="flex-basis: 50.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<caption>(a) Group means for Female reader</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">author</th>
<th style="text-align: center;">attractive</th>
<th style="text-align: center;">no-pic</th>
<th style="text-align: center;">unattractive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">female</td>
<td style="text-align: center;">50.5</td>
<td style="text-align: center;">69</td>
<td style="text-align: center;">90.75</td>
</tr>
<tr class="even">
<td style="text-align: center;">male</td>
<td style="text-align: center;">66.75</td>
<td style="text-align: center;">68</td>
<td style="text-align: center;">66.75</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-means2-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-means2" style="flex-basis: 50.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<caption>(b) Group means for Male reader</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">author</th>
<th style="text-align: center;">attractive</th>
<th style="text-align: center;">no-pic</th>
<th style="text-align: center;">unattractive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">female</td>
<td style="text-align: center;">87</td>
<td style="text-align: center;">70.5</td>
<td style="text-align: center;">51</td>
</tr>
<tr class="even">
<td style="text-align: center;">male</td>
<td style="text-align: center;">79.25</td>
<td style="text-align: center;">69.5</td>
<td style="text-align: center;">60.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-ints2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="bf3_files/figure-html/fig-ints2-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Author Gender and Attractiveness Interaction Plots Faceted by Reader Gender</figcaption>
</figure>
</div>
</div>
</div>
</div>
<!-- This plot works, but I want to use the one above because it seems more straigh forward -->
<p>DESCRIBE HOW THE PLOT ON THE LEFT AND THE PLOT ON THE RIGHT ARE DIFFERENT AND HOW THAT REPRESENTS A 3-WAY INTERACTION: WHEN THE NATURE OF THE 2 WAY INTERACTION DEPENDS ON THE THIRD FACTOR.</p>
</section>
<section id="appendix" class="level1 page-columns page-full">
<h1>Appendix</h1>
<p>Partitioning of the dataset that corresponds with the 7 structural factors in the 3 factor model.</p>
<div class="column-page">
<div id="fig-partition_main" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/bf3_partition_main.PNG" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Data Partition for Single Factors</figcaption>
</figure>
</div>
<div id="fig-partition_2way" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/bf3_partition_2way.PNG" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Data Partition for 2-Way Interaction Factors</figcaption>
</figure>
</div>
<div id="fig-partition_3way" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/bf3_partition_3way.PNG" class="img-fluid figure-img" width="490"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Data Partition for 3-Way Interaction Factor</figcaption>
</figure>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>